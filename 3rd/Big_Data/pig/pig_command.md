# Pic Command

[Back](../index.md)

- [Pic Command](#pic-command)
  - [Pig Grunt Shell](#pig-grunt-shell)
  - [Function](#function)
  - [PARALLEL Clause](#parallel-clause)

---

## Pig Grunt Shell

- Linux

```sh
pig
```

- Pig: Linux Shell Commands

| Pig Command             | Description |
| ----------------------- | ----------- |
| `sh pwd`                | PWD         |
| `sh ls -alF /root/lab/` | LS          |
| `sh ls -alF /root/lab/` | LS          |

- Pig: HDFS Commands

| Pig Command                           | Description             |
| ------------------------------------- | ----------------------- |
| `fs -ls /user`                        | ls                      |
| `fs -ls /user/root/pig`               | ls                      |
| `rmf /user/root/pig/full_text_limit3` | remove a file/directory |

- Pig Commands

| Pig Command                | Description                                       |
| -------------------------- | ------------------------------------------------- |
| `exec /root/lab/test1.pig` | execute pig script(parameters/relations not pass) |
| `run /root/lab/test1.pig`  | execute pig script(parameters are passed)         |

---

- Relation Operators

| Operators                         | Description                                 |
| --------------------------------- | ------------------------------------------- |
| `LOAD 'path'`                     | Loads data from the file system.            |
| `STORE INTO 'path'`               | Stores or saves results to the file system. |
| `FOREACH`                         | Apply transformations on every row.         |
| `FILTER BY bool_exp`              | Filtering Data                              |
| `GROUP BY`                        | Groups the data                             |
| `SAMPLE size`                     | Selects a random sample of data             |
| `JOIN rel01 BY col, rel02 BY col` | Join two or more relations                  |
| `LIMIT size`                      | Limits the number of output tuples.         |

---

## Function

- DATE/Time functions

| Func            | Desc |
| --------------- | ---- |
| `CurrentTime()` |      |
| `GetYear()`     |      |
| `GetMonth()`    |      |
| `GetDay()`      |      |
| `GetWeek()`     |      |
| `ToDate()`      |      |
| `ToString()`    |      |
| `ToUnixTime()`  |      |

---

- Arithmetic Operators

| Operator  | Description                     |
| --------- | ------------------------------- |
| `Flatten` | un-nests tuples, bags and maps. |

- Flatten

  - flatten turns tuples into columns

```sh
c = GROUP b BY (id, date);
d = FOREACH c GENERATE FLATTEN(group) AS (id,date)
# degroup into id and date columns
```

- flatten turns bags into rows

```sh
b = foreach a generate id, SUBSTRING(ts, 0, 10) as date, lat, lon, tweet;
c = GROUP b BY (id, date);
d = FOREACH c GENERATE FLATTEN(b) AS (id, date, lat, lon, tweet);
# degroup into id and date columns
```

---

## PARALLEL Clause

- `PARALLEL` Clause
  - sets the **number of reduce tasks** for the MapReduce jobs generated by Pig.
  - The default value is 1 (one reduce task).
    - If you donâ€™t specify PARALLEL, you still get the same map parallelism but only one reduce task.
  - **only** affects the number of **reduce** tasks.
    - Map parallelism is determined by the input file, one map for each HDFS block.

```sh
a = load '/user/root/pig/full_text.txt' AS (id:chararray, ts:chararray, location:chararray, lat:float, lon:float, tweet:chararray);
b = group a by id PARALLEL 18;
```

---

[TOP](#pic-command)
